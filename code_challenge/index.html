<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCU Code Challenge Registration</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter and VT323 fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=VT323&display=swap" rel="stylesheet">
    
    <style>
        /* Custom Variables and Global Styles */
        :root {
            --primary-color: rgb(170, 49, 86); /* Rose/Pink Glow (Hero Text & Timer) */
            --secondary-color: rgb(47, 93, 160); /* Deep Blue (Button) */
            --text-color: rgb(255, 255, 255);
            /* --bomb-red is no longer used, we now use --primary-color */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark GitHub-like background */
            background-image: radial-gradient(circle, #2a3c30 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text-color);
        }

        .vt323-regular {
            font-family: 'VT323', monospace;
        }

        /* Hero Text Typing Animation Style */
        .typing-hero {
            font-size: clamp(2rem, 10vw, 4rem);
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color);
            white-space: nowrap;
            overflow: hidden;
            display: inline-block;
        }

        .blinking-cursor {
            color: var(--primary-color);
            animation: blink-caret 1s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--primary-color); }
        }

        /* Card and Fade-in Effect */
        .card {
            background: rgba(22, 27, 34, 0.9); /* Semi-transparent dark background */
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            animation: fadeIn 1.5s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Button Glow Effect */
        .glow-button {
            transition: all 0.3s ease;
            box-shadow: 0 0 5px var(--secondary-color);
        }
        .glow-button:hover {
            box-shadow: 0 0 10px var(--secondary-color), 0 0 20px var(--secondary-color);
        }

        /* Input Field Styling */
        .form-input {
            background-color: #161b22;
            border-color: #30363d;
            color: var(--text-color);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(170, 49, 86, 0.5); /* Primary glow on focus */
        }

        .submit-button {
            background-color: var(--secondary-color);
            transition: background-color 0.3s ease;
        }
        .submit-button:hover {
            background-color: rgb(37, 74, 127);
        }

        /* Bomb Timer Styling - Updated to use Primary Color */
        #countdown-timer {

        }
        #timer-display {
            color: var(--primary-color);
            /* Use primary color for the text shadow */
            text-shadow: 0 0 10px rgba(170, 49, 86, 0.8);
            font-weight: 700;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <div class="card container max-w-xl mx-auto flex flex-col items-center justify-center p-6 md:p-8 rounded-xl shadow-2xl space-y-6">

        <!-- Typing Hero Title -->
        <div class="h-16 flex items-center justify-center">
            <h1 class="typing-hero vt323-regular" id="hero-text"></h1>
        </div>

        <!-- === BOMB TIMER DISPLAY === -->
        <div id="countdown-timer" class="text-center mb-6 p-4 rounded-lg w-full">
            <!-- text-red-400 replaced with inline style using primary color -->
            <p class="text-lg font-bold mb-2" style="color: var(--primary-color); text-shadow: 0 0 5px rgba(170, 49, 86, 0.5);">REGISTRATION FOR ROUND 1 CLOSES IN:</p>
            <div class="vt323-regular text-4xl sm:text-6xl" id="timer-display">
                --D : --H : --M : --S
            </div>
        </div>
        
        <!-- Timer Expired Message (Initially Hidden) -->
        <div id="closed-view" class="hidden text-center p-8 space-y-6 w-full">
            <!-- Consistency: Ensure the closed message matches the new primary glow color -->
            <h3 class="text-4xl vt323-regular animate-pulse" style="color: var(--primary-color); text-shadow: 0 0 10px rgba(170, 49, 86, 0.8);">ACCESS DENIED!</h3>
            <p class="text-xl text-gray-300">Registration is now **closed**. The self-destruct sequence is complete.</p>
            <p class="text-sm text-gray-500">Thank you for your interest. Please await further announcements.</p>
        </div>
        

        <!-- Confirmation Message Container (Hidden after successful submit) -->
        <div id="confirmation-view" class="hidden text-center p-8 space-y-6">
            <svg class="mx-auto h-20 w-20 text-green-400 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <h3 class="text-3xl vt323-regular text-green-400">REGISTRATION SUCCESSFUL!</h3>
            <p class="text-xl text-gray-300">You're in. Get ready to hack and may the compiler be ever in your favor.</p>
            <p class="text-sm text-gray-500">The data has been dispatched to the challenge organizers.</p>
        </div>

        <!-- Form View Container -->
        <div id="form-view" class="form-container w-full">
        
            
            <!-- Google Form Structure -->
            <form action="https://docs.google.com/forms/d/e/1FAIpQLSfnBD355pxdY3qzGBCzGJ1NYN_lF6J7XjmJR8QiUHv4cxrqKw/formResponse"
                  target="_self"
                  id="bootstrapForm"
                  method="POST" 
                  class="space-y-4">
                
                <!-- 1. Names (entry.1150333983) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Full Names:</legend>
                    <div class="form-group">
                        <input id="1150333983" type="text" name="entry.1150333983" required placeholder="First Name" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- 2. Course (entry.257550606) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Course:</legend>
                    <div class="form-group">
                        <input id="257550606" type="text" name="entry.257550606" required placeholder="e.g., BSc Computer Science" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- 3. Email (entry.1949379678) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Email:</legend>
                    <div class="form-group">
                        <input id="1949379678" type="email" name="entry.1949379678" required placeholder="yourmail@gmail.com" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- 4. Phone Number (entry.769696501) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Phone Number:</legend>
                    <div class="form-group">
                        <input id="769696501" type="tel" name="entry.769696501" required placeholder="+256 7XX XXX XXX" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- 5. Year of Study (entry.1551643770) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Year of Study:</legend>
                    <div class="form-group">
                        <input id="1551643770" type="number" name="entry.1551643770" min="1" max="5" required placeholder="e.g., 2" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- 6. Individual/Squad (entry.2007816248) -->
                <fieldset>
                    <legend class="block text-sm font-medium text-gray-300 mb-1">Individual/Squad:</legend>
                    <div class="form-group">
                        <input id="2007816248" type="text" name="entry.2007816248" required placeholder="Team Name or 'Individual'" class="form-input mt-1 block w-full px-4 py-2 border rounded-md shadow-sm sm:text-sm">
                    </div>
                </fieldset>

                <!-- Hidden Google Form fields -->
                <input type="hidden" name="fvv" value="1">
                <input type="hidden" name="fbzx" value="-1119307440981813990">
                <input type="hidden" name="pageHistory" value="0">

                <div class="pt-4 text-center">
                    <button type="submit" class="w-full px-8 py-3 submit-button text-white rounded-lg font-bold glow-button text-lg">
                        Submit & Start Hacking
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        const textElement = document.getElementById('hero-text');
        const textToType = "UCU CODE CHALLENGE";
        let i = 0;
        const typingSpeed = 100; // milliseconds

        const timerDisplay = document.getElementById('timer-display');
        const countdownTimer = document.getElementById('countdown-timer');
        const formView = document.getElementById('form-view');
        const closedView = document.getElementById('closed-view');
        const confirmationView = document.getElementById('confirmation-view');
  
        const targetDate = new Date('October 17, 2025 17:59:00').getTime();

        function pad(num) {
            return String(num).padStart(2, '0');
        }

        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetDate - now;

            if (distance < 0) {
                // Time's up! Registration closed.
                clearInterval(countdownInterval);
                countdownTimer.classList.add('hidden');
                formView.classList.add('hidden');
                closedView.classList.remove('hidden');
                return;
            }

            // Time calculations for days, hours, minutes and seconds
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display the result
            timerDisplay.innerHTML = 
                `${pad(days)}D : ${pad(hours)}H : ${pad(minutes)}M : ${pad(seconds)}S`;
        }

        function typeWriter() {
            if (i < textToType.length) {
                textElement.innerHTML += textToType.charAt(i);
                i++;
                setTimeout(typeWriter, typingSpeed);
            } else {
                const cursor = document.querySelector('.blinking-cursor');
                if (cursor) cursor.style.display = 'inline';
            }
        }

        // Add a blinking cursor effect
        const cursor = document.createElement('span');
        cursor.className = 'blinking-cursor';
        cursor.textContent = '_';
        cursor.style.display = 'none'; // Initially hide it
        textElement.parentNode.insertBefore(cursor, textElement.nextSibling);

        // Start the countdown immediately (or on window load)
        const countdownInterval = setInterval(updateCountdown, 1000);
        updateCountdown(); // Run once immediately to prevent flicker

        // --- Submission Logic ---
        window.onload = function() {
            typeWriter();
            
            const form = document.getElementById('bootstrapForm');
            const submitButton = form.querySelector('button[type="submit"]');

            // Check if registration is already closed on load
            if (closedView.classList.contains('hidden')) {

                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    if (!form.checkValidity()) {
                        form.reportValidity();
                        return; 
                    }

                    // Show loading state
                    submitButton.textContent = 'TRANSMITTING DATA...';
                    submitButton.disabled = true;

                    const formData = new FormData(form);
                    
                    // Construct URL-encoded payload
                    const urlSearchParams = new URLSearchParams();
                    for (const pair of formData) {
                        urlSearchParams.append(pair[0], pair[1]);
                    }
                    const payload = urlSearchParams.toString();
                    
                    // Google Form Submission via fetch (no-cors mode prevents redirection)
                    try {
                        await fetch(form.action, {
                            method: 'POST',
                            mode: 'no-cors', 
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                            },
                            body: payload,
                        });

                        // Success UI Update
                        formView.classList.add('hidden');
                        confirmationView.classList.remove('hidden');
                        
                    } catch (error) {
                        // In 'no-cors' mode, we treat any response as a successful dispatch
                        console.error('Fetch completed with expected no-cors issue. Data presumed sent.', error);

                        // Success UI Update
                        formView.classList.add('hidden');
                        confirmationView.classList.remove('hidden');

                    } finally {
                        submitButton.textContent = 'Submit & Start Hacking';
                        submitButton.disabled = false;
                    }
                });
            }
        };

    </script>
</body>
</html>
